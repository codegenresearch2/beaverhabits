from nicegui import ui\\nfrom beaverhabits.frontend import components\\nfrom beaverhabits.frontend.components import (\\n    HabitAddButton, HabitDeleteButton, HabitNameInput, HabitStarCheckbox)\\nfrom beaverhabits.frontend.layout import layout\\nfrom beaverhabits.logging import logger\\nfrom beaverhabits.storage.storage import HabitList\\n\\nclass Habit:\\n    def __init__(self, name, status=None):\\n        self.name = name\\n        self.status = status or 'active'\\n\\nclass DictHabit(Habit):\\n    def __init__(self, name, status=None):\\n        super().__init__(name, status)\\n\\nclass HabitList:\\n    def __init__(self, habits=None, order=None):\\n        self.habits = habits or []\\n        self.order = order or []\\n\\nclass DictHabitList(HabitList):\\n    def __init__(self, habits=None, order=None):\\n        super().__init__(habits, order)\\n\\nasync def item_drop(e, habit_list: HabitList):\\n    elements = ui.context.client.elements\\n    dragged = elements[int(e.args['id'][1:])]\\n    dragged.move(target_index=e.args['new_index'])\\n    habits = [x.habit for x in dragged.parent_slot.children if isinstance(x, components.HabitOrderCard) and x.habit]\\n    habit_list.order = [str(x.id) for x in habits]\\n    logger.info(f'New order: {habits}')\\n\\n@ui.refreshable\\ndef add_ui(habit_list: HabitList):\\n    with ui.column().classes('sortable').classes('gap-3'):\\n        for item in habit_list.habits:\\n            with components.HabitOrderCard(item):\\n                with ui.grid(columns=12, rows=1).classes('gap-0 items-center'):\\n                    name = HabitNameInput(item)\\n                    name.classes('col-span-3 col-3').props('borderless')\\n                    ui.space().classes('col-span-7')\\n                    star = HabitStarCheckbox(item, add_ui.refresh)\\n                    star.classes('col-span-1')\\n                    delete = HabitDeleteButton(item, habit_list, add_ui.refresh)\\n                    delete.classes('col-span-1')\\n\\nclass HabitOrderCard(ui.card):\\n    def __init__(self, habit=None):\\n        super().__init__()\\n        self.habit = habit\\n\\ndef order_page_ui(habit_list: HabitList):\\n    with layout():\\n        with ui.column().classes('w-full pl-1 items-center gap-3'):\\n            add_ui(habit_list)\\n            with HabitOrderCard():\\n                with ui.grid(columns=12, rows=1).classes('gap-0 items-center'):\\n                    add = HabitAddButton(habit_list, add_ui.refresh)\\n                    add.classes('col-span-12').props('borderless')\\n    ui.add_body_html(\\n        r'''\\n        <script type='module'>\\n        import '/statics/libs/sortable.min.js';\\n        document.addEventListener('DOMContentLoaded', () => {\\n            Sortable.create(document.querySelector('.sortable'), {\\n                animation: 150,\\n                ghostClass: 'opacity-50',\\n                onEnd: (evt) => emitEvent('item_drop', {id: evt.item.id, new_index: evt.newIndex }),\\n            });\\n        });\\n        </script>\\n    '''\\n    )\\n    ui.on('item_drop', lambda e: item_drop(e, habit_list))